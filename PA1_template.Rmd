---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


Set global options
```{r setoptions, echo = TRUE}
library(knitr)
opts_chunk$set(echo=TRUE)
```


## Loading and preprocessing the data
```{r, ReadData}
unzip("activity.zip")
MyDF<-read.csv('activity.csv',colClasses = c("integer","Date","integer"))
```

## What is mean total number of steps taken per day?

```{r}
library(dplyr)
MyDF_group<-summarise(group_by(MyDF,date),total=sum(steps))
```

#A histogram of the total number of steps taken each day 
```{r}
hist(MyDF_group$total)
```

#The mean and median of the total number of steps taken per day

```{r}
mean(MyDF_group$total,na.rm = TRUE)
```

#The median and median of the total number of steps taken per day

```{r}
median(MyDF_group$total,na.rm = TRUE)
```


## What is the average daily activity pattern?
```{r}
t<-as.character(MyDF$interval)
z0<-sapply(4-nchar(t),FUN=function(x) paste0(rep("0",x), collapse = ''))
MyDF$HH24<-paste0(z0,t)
MyDF_group_Time<-summarise(group_by(MyDF,HH24),avg=mean(steps,na.rm = TRUE))
plot(MyDF_group_Time$HH24,MyDF_group_Time$avg,type = "l",xlab = "Time",ylab = "average number of steps",axes = FALSE,main="Average daily activity pattern",sub="Average number of steps taken per 5 minutes")
axis(2)
axis(1, at=c(0,500,1000,1500,2000),labels =c("00:00","05:00","10:00","15:00","20:00"),las=2)
box()
```


#Find which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps

```{r}
MyDF_group_Time[MyDF_group_Time$avg==max(MyDF_group_Time$avg),]
```

## Imputing missing values

# total number of rows with NAs
```{r}
length(MyDF[is.na(MyDF$steps),]$steps)
```

```{r}
MyDF_groupNew<-MyDF_group
day_mean<-round(mean(MyDF_group$total,na.rm = TRUE ))
MyDF_groupNew[is.na(MyDF_group$total),"total"]<-day_mean  
```

## Are there differences in activity patterns between weekdays and weekends?
